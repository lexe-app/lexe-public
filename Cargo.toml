[package]
name = "node"
version = "0.1.0"
authors = [
    "Max Fang <protonmail.com@maxfa.ng>",
    "Philip Hayes <philiphayes9@gmail.com>"
]
license = "MIT"
edition = "2021"

# See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html

[dependencies]
lightning = { version = "0.0.108", features = ["max_level_trace"] }
lightning-block-sync = { version = "0.0.108", features = [ "rpc-client" ] }
lightning-invoice = { version = "0.16" }
lightning-net-tokio = { version = "0.0.108" }
lightning-background-processor = { version = "0.0.108" }
lightning-rapid-gossip-sync = { version = "0.0.108" }

# lightning = { git = "https://github.com/lexe-tech/rust-lightning", features = ["max_level_trace"], branch = "lightning-net-tokio-sgx-v0.0.108" }
# lightning-block-sync = { git = "https://github.com/lexe-tech/rust-lightning", features = [ "rpc-client" ], branch = "lightning-net-tokio-sgx-v0.0.108" }
# lightning-invoice = { git = "https://github.com/lexe-tech/rust-lightning", branch = "lightning-net-tokio-sgx-v0.0.108" }
# lightning-net-tokio = { git = "https://github.com/lexe-tech/rust-lightning", branch = "lightning-net-tokio-sgx-v0.0.108" }
# lightning-background-processor = { git = "https://github.com/lexe-tech/rust-lightning", branch = "lightning-net-tokio-sgx-v0.0.108" }
# lightning-rapid-gossip-sync = { git = "https://github.com/lexe-tech/rust-lightning", branch = "lightning-net-tokio-sgx-v0.0.108" }

# Ad hoc error definition, easy error propagation, error chains
anyhow = "1"
# Easy error definition
thiserror = "1"

base64 = "0.13.0"
bitcoin = "0.28.1"
bitcoin-bech32 = "0.12"
bech32 = "0.8"
hex = "0.3"

futures = "0.3"
chrono = "0.4"
# Used to specify the HTTP methods used to interact with the API
http = "0.2"

# Used to hold a Tokio runtime used by the sync fns in the Persister trait impl
once_cell = "1"
rand = "0.4"
# Used to make reqwests to the API
reqwest = { version = "0.11", default-features = false, features = ["json"] }
# Used to serialize / deserialize from API
serde = { version = "1", features = ["derive"] }
serde_qs = "0"
serde_json = "1"

# Use the specific patched versions
hyper = "=0.14.18"
mio = "=0.7.6"
tokio = { version = "=1.15.0", default-features = false, features = [ "io-util", "macros", "rt", "rt-multi-thread", "sync", "time" ] }
# lightning-net-tokio = "=0.0.107"
# tokio = { version = "=1.15.0", default-features = false, features = [
# "io-util", "macros", "net", "rt", "time"] }

[patch.crates-io]
async-usercalls = { git = "https://github.com/lexe-tech/rust-sgx", branch = "lexe" }
hyper = { git = "https://github.com/lexe-tech/hyper", branch = "hyper-sgx-0.14.18" }
mio = { git = "https://github.com/lexe-tech/mio", branch = "mio-sgx-0.7.6" }
tokio = { git = "https://github.com/lexe-tech/tokio",  branch = "tokio-sgx-1.15.0" }
# lightning-net-tokio = { git = "https://github.com/lexe-tech/rust-lightning", branch = "lightning-net-tokio-sgx-v0.0.107"}
# These two are not needed yet
# atty = { git = "https://github.com/softprops/atty", rev = "6633c0e1446aa19e6cd00e00e39770da43081bda" }
# ring = { git = "https://github.com/lexe-tech/ring", branch = "support-sgx-0.16.20" }

[package.metadata.fortanix-sgx]
# stack size (in bytes) for each thread, the default stack size is 0x20000.
stack-size=0x200000
# Gotcha: Don't forget to count the main thread when counting number of
# threads.
threads=7

[profile.release]
panic = "abort"

[profile.dev]
panic = "abort"
